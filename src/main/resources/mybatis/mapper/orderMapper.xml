<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.campusfavour.mapper.OrderMapper">
    <sql id="fields">
        id,
        orderStatus,
        releaseUserName,
        releaseUserId,
        releaseTime,
        receiveUserName,
        receiveUserId,
        receiveTime,
        orderType,
        startPlace,
        endPlace,
        detail
    </sql>
    <sql id="releaseOrder">
        orderStatus,
        releaseUserName,
        releaseUserId,
        releaseTime,
        orderType,
        startPlace,
        endPlace,
        detail
    </sql>

    <select id="selectOrdersByParam" parameterType="java.util.Map" resultType="com.campusfavour.entity.Order">
        select
        <include refid="fields"></include>
        from `order`
        <where>
            <if test="id != null">
                AND id = #{id}
            </if>
            <if test="taskStatus != null">
                AND taskStatus = #{taskStatus}
            </if>
            <if test="releaseUserName != null">
                AND releaseUserName = #{releaseUserName}
            </if>
            <if test="releaseUserId != null">
                AND releaseUserId = #{releaseUserId}
            </if>
            <if test="receiveUserName != null">
                AND receiveUserName = #{receiveUserName}
            </if>
            <if test="receiveUserId != null">
                AND receiveUserId = #{receiveUserId}
            </if>
            <if test="orderType != null">
                AND orderType = #{orderType}
            </if>
        </where>
    </select>

    <insert id="releaseOrder" parameterType="java.util.Map" useGeneratedKeys="true" keyProperty="id">
        insert into `order`(
           <include refid="releaseOrder"></include>
       )
       values(
       #{orderStatus},
       #{releaseUserName},
       #{releaseUserId},
       #{releaseTime},
       #{orderType},
       #{startPlace},
       #{endPlace},
       #{detail}
        )
    </insert>

    <update id="acceptOrder" parameterType="Map">
        update `order`
        set
        receiveUserName = #{receiveUserName},
        receiveUserId = #{receiveUserId},
        receiveTime = #{receiveTime}
        where
        id = #{id}
    </update>

    <select id="usersOrders" parameterType="Map" resultType="com.campusfavour.entity.Order">
        select
        <include refid="fields"></include>
        from `order`
        <where>
            <if test="id != null and id != ''">
                AND id = #{id}
            </if>
            <if test="taskStatus != null and taskStatus != ''">
                AND taskStatus = #{taskStatus}
            </if>
            <if test="releaseUserName != null and releaseUserName != ''">
                AND releaseUserName = #{releaseUserName}
            </if>
            <if test="releaseUserId != null and releaseUserId != ''">
                AND releaseUserId = #{releaseUserId}
            </if>
            <if test="receiveUserName != null and receiveUserName != ''">
                AND receiveUserName = #{receiveUserName}
            </if>
            <if test="receiveUserId != null and receiveUserId != ''">
                AND receiveUserId = #{receiveUserId}
            </if>
            <if test="orderType != null and orderType != ''">
                AND orderType = #{orderType}
            </if>
        </where>
    </select>
</mapper>
